# IndieWebClub Bangalore Website

This repository contains the source code for the [IndieWebClub Bangalore website](https://blr.indiewebclub.org/), a static site generated using Python. The website displays upcoming and past events, and a blogroll of recent posts from the community.

## Features

- **Event Aggregation**: Fetches event data from the Underline Center Discourse API.
- **Blogroll Generation**: Aggregates recent blog posts from a list of RSS/Atom feeds defined in `blogroll.opml`.
- **Static Site Generation**: Creates a static HTML website using `pystache` for templating.
- **Feed Generation**: Produces Atom feeds for both the blogroll and events.
- **Calendar Generation**: Creates an iCalendar (`.ics`) file for events.
- **CI/CD**: Automatically builds and deploys the website to GitHub Pages using GitHub Actions.

## Installation

### Prerequisites

- Python 3.x
- `make`

### Installation and Setup

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/IndieWebClubBlr/website.git
    cd website
    ```

2.  **Set up the environment and install dependencies:**
    The `Makefile` provides a convenient way to set up a Python virtual environment and install the required dependencies from `requirements.txt`.

    ```bash
    make setup
    ```

    You can run `make` or `make help` at any time to see a list of all available commands.

3.  **Activate the virtual environment if required:**
    ```bash
    source venv/bin/activate
    ```

## Usage

The following commands are available through the `Makefile`.

### Common Commands

-   **`make build`**: Build the website. This will generate the static files in the `_site` directory. For faster builds during development, you can enable caching by running `make build CACHE=true`.
-   **`make serve`**: Serve the website locally for development. You can view the site at `http://localhost:8000`.
-   **`make watch`**: Automatically rebuild the site when files change.

### Other Commands

-   **`make install`**: Install or update dependencies if `requirements.txt` changes.
-   **`make clean`**: Remove the generated `_site` directory.
-   **`make clean_all`**: Perform a full cleanup, removing the `_site` directory, the `venv`, and the cache.

## How it Works

The website is generated by the `generator.py` script. This script performs the following steps:

1.  **Parses `blogroll.opml`**: Reads the list of community blog feeds.
2.  **Fetches Feeds**: Concurrently fetches the content of each feed.
3.  **Fetches Events**: Retrieves event information from the Underline Center Discourse API.
4.  **Generates HTML**: Uses the `index.html` template to generate the final `index.html` page with the aggregated content.
5.  **Generates Feeds and Calendar**: Creates Atom feeds for the blogroll and events, and an iCalendar file for events.

The generated site is then deployed to the `gh-pages` branch of the repository.

## Configuration

The project's behavior can be customized through the `config.py` file. This file includes settings for request timeouts, content length limits, feed and calendar file names, and more. Some of the key options you might want to modify are:

-   `MAX_SHOWN_ENTRIES`: The number of posts to display per blog on the homepage.
-   `RECENT_DAYS`: The time window in days for fetching recent blog posts.
-   `MAX_FEED_ENTRIES`: The maximum number of entries to fetch from each feed.

## Project Structure

A brief overview of the project's file structure:

```
/
├── .github/           # GitHub Actions workflows for CI/CD.
├── _site/             # Output directory for the generated website.
├── CNAME              # Custom domain configuration for GitHub Pages.
├── LICENSE            # The license for the project.
├── README.md          # This file.
├── Makefile           # Contains all the commands for building, serving, and cleaning the project.
├── config.py          # All configuration constants for the project.
├── events.py          # Logic for fetching events from the Discourse API.
├── feeds.py           # Logic for fetching and parsing blogroll feeds.
├── generator.py       # Main script to generate the static site.
├── index.html         # The main pystache template for the website.
├── style.css          # Main stylesheet.
├── blogroll.opml      # The list of feeds for the blogroll.
├── favicon.svg        # The website favicon image.
├── preview.png        # The website OpenGraph preview image.
├── pyrightconfig.json # Configuration file for the Pyright type checker.
├── requirements.txt   # Python dependencies for the project.
├── shell.nix          # Nix shell configuration for reproducible development environments.
└── watch.sh           # A script to watch for file changes and rebuild the site.
```

## Contributing

Contributions are welcome! Please feel free to open an issue or submit a pull request.

## License

This project is licensed under the MIT License. See the `LICENSE` file for details.
